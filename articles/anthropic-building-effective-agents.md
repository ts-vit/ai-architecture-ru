# Создание эффективных ИИ-агентов (Building Effective Agents)

*Оригинал статьи: [Anthropic Research](https://www.anthropic.com/research/building-effective-agents)*

За последний год мы работали с десятками команд, создающих агентов на базе больших языковых моделей (LLM) в различных отраслях. Самыми успешными оказались не те реализации, которые использовали сложные фреймворки, а те, что строились на простых, компонуемых паттернах.

В этом посте мы делимся опытом и даем практические советы по созданию эффективных агентов.

---

## Что такое агенты?

Термин «агент» трактуется по-разному. В Anthropic мы разделяем **агентные системы** на две категории:

1.  **Рабочие процессы (Workflows):** Системы, где LLM и инструменты оркеструются через заранее определенные пути в коде.
2.  **Агенты (Agents):** Системы, где LLM динамически управляет своими процессами и использованием инструментов, сохраняя контроль над тем, как выполняется задача.

---

## Когда (и когда не) использовать агентов

Мы рекомендуем искать **самое простое решение** и увеличивать сложность только при необходимости. Агентные системы часто требуют больше времени (latency) и стоят дороже в обмен на качество выполнения задач.

*   **Workflows** — лучше для предсказуемых и четко определенных задач.
*   **Agents** — лучше для задач, требующих гибкости и принятия решений моделью в масштабе.

---

## Паттерны агентных систем

### 1. Базовый блок: Дополненная LLM (Augmented LLM)
Это LLM, усиленная поиском (retrieval), инструментами (tools) и памятью (memory). Мы рекомендуем использовать стандарт **Model Context Protocol (MCP)** для легкой интеграции.

### 2. Цепочки промптов (Prompt Chaining)
Декомпозиция задачи на последовательность шагов. Каждый вызов LLM обрабатывает вывод предыдущего. Идеально для фиксированных подзадач.

### 3. Маршрутизация (Routing)
Классификация входных данных и направление их на специализированную подзадачу. Позволяет использовать разные промпты и инструменты для разных типов запросов.

### 4. Параллелизация (Parallelization)
Параллельное выполнение независимых подзадач с последующим агрегированием результата.
*   **Sectioning:** Разделение задачи на части.
*   **Voting:** Запуск одной задачи несколько раз для выбора лучшего ответа.

### 5. Оркестратор-исполнители (Orchestrator-Workers)
Центральная LLM динамически разбивает задачу и делегирует её «рабочим» моделям. Подходит для задач, где количество шагов непредсказуемо (например, кодинг).

### 6. Оценщик-оптимизатор (Evaluator-Optimizer)
Цикл, где одна LLM генерирует ответ, а другая оценивает его и дает обратную связь. Аналог процесса итеративного письма у человека.

---

## Автономные Агенты

Агенты планируют и действуют независимо, получая данные из среды (результаты работы инструментов) на каждом шагу. Важно:
*   Тщательно проектировать наборы инструментов (ACI — Agent-Computer Interface).
*   Предусматривать условия остановки (например, лимит итераций).
*   Тестировать в песочницах из-за риска накопления ошибок.

---

## Резюме: Три принципа успеха

1.  **Простота дизайна:** Не усложняйте структуру без нужды.
2.  **Прозрачность:** Явно показывайте шаги планирования агента.
3.  **Качественный интерфейс инструментов (ACI):** Документируйте и тестируйте инструменты так же тщательно, как и основные промпты.

*Авторы: Erik Schluntz и Barry Zhang (Anthropic).*
